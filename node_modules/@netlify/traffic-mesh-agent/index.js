/**
 * Gets a path to the traffic mesh binary for the local system.
 *
 * Throws an error if there is no traffic-mesh binary for the current platform.
 *
 * @returns {string} a file path to the traffic mesh binary for the local system.
 */
const getTrafficMeshForLocalSystem = () => {
  if (
    process.platform !== "darwin" &&
    process.platform !== "linux" &&
    process.platform !== "win32"
  ) {
    throw new Error(`There is no traffic-mesh binary for ${process.platform}.`);
  } else if (process.arch !== "x64") {
    throw new Error(`traffic-mesh only supports 64-bit x86 machines at the moment`);
  }

  return require(`@netlify/traffic-mesh-agent-${process.platform}-${process.arch}`);
};

module.exports = { getTrafficMeshForLocalSystem };
